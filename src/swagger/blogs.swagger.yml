paths:
  /:
    get:
      tags:
        - Root
      summary: API health/version endpoint
      operationId: getApiVersion
      responses:
        '200':
          description: API version info
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RootVersionResponse'

  /blogs:
    get:
      tags:
        - Blogs
      summary: Get all blogs
      operationId: getAllBlogs
      responses:
        '200':
          description: List of blogs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/BlogViewModel'
    post:
      tags:
        - Blogs
      summary: Create a blog
      operationId: createBlog
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUpdateBlogInputModel'
      responses:
        '201':
          description: Blog created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlogViewModel'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized

  /blogs/{id}:
    get:
      tags:
        - Blogs
      summary: Get blog by id
      operationId: getBlogById
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Blog found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlogViewModel'
        '404':
          description: Blog not found
    put:
      tags:
        - Blogs
      summary: Update blog by id
      operationId: updateBlogById
      security:
        - BasicAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUpdateBlogInputModel'
      responses:
        '204':
          description: Blog updated
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
        '404':
          description: Blog not found
    delete:
      tags:
        - Blogs
      summary: Delete blog by id
      operationId: deleteBlogById
      security:
        - BasicAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Blog deleted
        '401':
          description: Unauthorized
        '404':
          description: Blog not found

  /posts:
    get:
      tags:
        - Posts
      summary: Get all posts
      operationId: getAllPosts
      responses:
        '200':
          description: List of posts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PostViewModel'
    post:
      tags:
        - Posts
      summary: Create a post
      operationId: createPost
      security:
        - BasicAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUpdatePostInputModel'
      responses:
        '201':
          description: Post created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostViewModel'
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized

  /posts/{id}:
    get:
      tags:
        - Posts
      summary: Get post by id
      operationId: getPostById
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '200':
          description: Post found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PostViewModel'
        '404':
          description: Post not found
    put:
      tags:
        - Posts
      summary: Update post by id
      operationId: updatePostById
      security:
        - BasicAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUpdatePostInputModel'
      responses:
        '204':
          description: Post updated
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Unauthorized
        '404':
          description: Post not found
    delete:
      tags:
        - Posts
      summary: Delete post by id
      operationId: deletePostById
      security:
        - BasicAuth: []
      parameters:
        - $ref: '#/components/parameters/IdPathParam'
      responses:
        '204':
          description: Post deleted
        '401':
          description: Unauthorized
        '404':
          description: Post not found

  /testing/all-data:
    delete:
      tags:
        - Testing
      summary: Delete all blogs and posts from in-memory database
      operationId: deleteAllData
      responses:
        '204':
          description: Data deleted

components:
  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic

  parameters:
    IdPathParam:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: Resource identifier

  schemas:
    RootVersionResponse:
      type: object
      required:
        - version
      properties:
        version:
          type: string
          example: '1.0'

    BlogViewModel:
      type: object
      required:
        - id
        - name
        - description
        - websiteUrl
      properties:
        id:
          type: string
          example: '1'
        name:
          type: string
          maxLength: 15
          example: Tech Trends
        description:
          type: string
          maxLength: 500
          example: Latest trends in technology and software.
        websiteUrl:
          type: string
          maxLength: 100
          format: uri
          example: https://techtrends.io

    CreateUpdateBlogInputModel:
      type: object
      required:
        - name
        - description
        - websiteUrl
      properties:
        name:
          type: string
          maxLength: 15
          example: Tech Trends
        description:
          type: string
          maxLength: 500
          example: Latest trends in technology and software.
        websiteUrl:
          type: string
          maxLength: 100
          format: uri
          example: https://techtrends.io

    PostViewModel:
      type: object
      required:
        - id
        - title
        - shortDescription
        - content
        - blogId
        - blogName
      properties:
        id:
          type: string
          example: '101'
        title:
          type: string
          maxLength: 30
          example: Latest AI Innovations
        shortDescription:
          type: string
          maxLength: 100
          example: Discover the most exciting AI breakthroughs.
        content:
          type: string
          maxLength: 1000
          example: AI is advancing rapidly across many industries.
        blogId:
          type: string
          example: '2'
        blogName:
          type: string
          example: Tech Trends

    CreateUpdatePostInputModel:
      type: object
      required:
        - title
        - shortDescription
        - content
        - blogId
      properties:
        title:
          type: string
          maxLength: 30
          example: Latest AI Innovations
        shortDescription:
          type: string
          maxLength: 100
          example: Discover the most exciting AI breakthroughs.
        content:
          type: string
          maxLength: 1000
          example: AI is advancing rapidly across many industries.
        blogId:
          type: string
          example: '2'

    ErrorItem:
      type: object
      required:
        - message
        - field
      properties:
        message:
          type: string
          example: Title field is required
        field:
          type: string
          example: title

    ErrorResponse:
      type: object
      required:
        - errorsMessages
      properties:
        errorsMessages:
          type: array
          items:
            $ref: '#/components/schemas/ErrorItem'
